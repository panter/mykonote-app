(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,n){e.exports=n(149)},11:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f});var a=n(3),r=n(4),i=n(7),s=n(5),o=n(6),c=n(105),l=n(104),u=n(8);function h(e,t,n){return g(e,t,n).promise}function d(e,t,n){return g(e,t,n)}function f(e,t){var n={};return Object.keys(e).forEach(function(a){n["".concat(t,"[").concat(a,"]")]=e[a]}),n}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2?arguments[2]:void 0;e=function(e){if(!window.API_HOST)return e;return"".concat(window.API_HOST).concat(e)}(e);var a=setTimeout(function(){u.a.publish("spinner.toggle",{show:!0})},500),r=new AbortController,i=r.signal;return{promise:new Promise(function(r,s){var o,c=function(e,t,n,a){var r=function(e,t){return{method:e,signal:t,headers:{Accept:"application/json"}}}(t,a);if(n)if(n=Object.fromEntries(Object.entries(n).filter(function(e){var t=Object(l.a)(e,2),n=(t[0],t[1]);return void 0!==n})),"GET"===t){var i=new URLSearchParams(n);e="".concat(e,"?").concat(i)}else{var s=new FormData;Object.keys(n).forEach(function(e){return s.append(e,n[e])}),r.body=s}return{url:e,options:r}}(e,t,n,i);e=c.url,o=c.options,fetch(e,o).then(function(e){return function(e,t,n){e.ok&&204===e.status?t():e.ok?e.json().then(function(e){return t(e)}):e.json().then(function(t){return n(new v(e.statusText,e.status,t))})}(e,r,s)}).catch(function(e){return function(e,t){e instanceof DOMException&&"AbortError"===e.name||t(e)}(e,s)}).finally(function(){return clearTimeout(a),void u.a.publish("spinner.toggle",{show:!1})})}),controller:r}}var v=function(e){function t(e,n,r){var o;return Object(a.a)(this,t),(o=Object(i.a)(this,Object(s.a)(t).call(this,e))).name="AjaxError",o.status=n,o.responseJson=r,o}return Object(o.a)(t,e),Object(r.a)(t,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message,". ")+"Status: ".concat(this.status,".")+"ResponseJson: ".concat(JSON.stringify(this.responseJson))}}]),t}(Object(c.a)(Error))},112:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},137:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(34),s=n.n(i),o=n(3),c=n(4),l=n(7),u=n(5),h=n(6),d=n(154),f=n(155),g=n(103),v=n(156),p=n(11),m=n(15),b=n(25),y=n.n(b),k=n(8);y.a.prototype.stopCallback=function(){return!1},y.a.bind("alt+shift+f",function(){return k.a.publish("search.focus"),!1}),y.a.bind("alt+shift+n",function(){return k.a.publish("note.new"),!1});var E=n(27),O=n.n(E),w=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"generateV4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}}]),e}(),S=function(){function e(t,n,a,r,i,s){Object(o.a)(this,e),this._uid=t||w.generateV4(),this._title=n||"",this._content=a||"",this._createdAt=r||new Date,this._updatedAt=i||this._createdAt,this._serverUpdatedAt=this._updatedAt,this._archivedAt=s}return Object(c.a)(e,[{key:"setArchived",value:function(){this._archivedAt=new Date}},{key:"isNew",value:function(){return!this.title&&!this.content}},{key:"toJson",value:function(){return JSON.stringify({uid:this.uid,title:this.title,content:this.content,created_at:this.createdAt.toISOString(),updated_at:this.updatedAt.toISOString(),server_updated_at:this.serverUpdatedAt.toISOString(),archived_at:this.archivedAt?this.archivedAt.toISOString():null})}},{key:"uid",get:function(){return this._uid}},{key:"title",get:function(){return this._title},set:function(e){this._updatedAt=new Date,this._title=e}},{key:"content",get:function(){return this._content},set:function(e){this._updatedAt=new Date,this._content=e}},{key:"createdAt",get:function(){return this._createdAt}},{key:"updatedAt",get:function(){return this._updatedAt}},{key:"serverUpdatedAt",get:function(){return this._serverUpdatedAt},set:function(e){this._serverUpdatedAt=e}},{key:"archivedAt",get:function(){return this._archivedAt}}],[{key:"fromAttributes",value:function(t){return new e(t.uid,t.title,t.content,new Date(t.created_at),new Date(t.updated_at),t.archived_at?new Date(t.archived_at):null)}}]),e}(),j=n(9),L=(n(112),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.searchQuery?r.a.createElement("div",{className:"search-term"},'Showing results for "',this.props.searchQuery,'"'):null}}]),t}(a.Component)),C=n(21);function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function x(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var P=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),A=r.a.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),M=function(e){var t=e.svgRef,n=x(e,["svgRef"]);return r.a.createElement("svg",N({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),P,A)},I=r.a.forwardRef(function(e,t){return r.a.createElement(M,N({svgRef:t},e))}),T=(n.p,function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.renderLoadMoreButton(),this.renderSpinner())}},{key:"renderLoadMoreButton",value:function(){return this.props.showLoadMoreButton?this.props.showSpinner?null:r.a.createElement("button",{name:"load-more",className:"icon big full-width",onClick:this.handleLoadMoreClick.bind(this)},r.a.createElement(I,null)):null}},{key:"renderSpinner",value:function(){return this.props.showSpinner?r.a.createElement("div",{className:"icon big full-width"},r.a.createElement(C.a,null)):null}},{key:"handleLoadMoreClick",value:function(e){e.preventDefault(),e.currentTarget.blur(),this.props.handleLoadMoreClick(e)}}]),t}(a.Component)),R=n(35),_=n.n(R);function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function U(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var H=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),B=r.a.createElement("path",{d:"M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5L6.5 12H10v-2h4v2h3.5L12 17.5zM5.12 5l.81-1h12l.94 1H5.12z"}),z=function(e){var t=e.svgRef,n=U(e,["svgRef"]);return r.a.createElement("svg",D({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),H,B)},F=r.a.forwardRef(function(e,t){return r.a.createElement(z,D({svgRef:t},e))});n.p;function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function W(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var q=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),J=r.a.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),V=function(e){var t=e.svgRef,n=W(e,["svgRef"]);return r.a.createElement("svg",Q({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),q,J)},K=r.a.forwardRef(function(e,t){return r.a.createElement(V,Q({svgRef:t},e))}),Y=(n.p,n(114),function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).state={notes:[],currentPage:1,hasMorePages:!1,isLoadingMorePages:!0,isSynced:!1,searchQuery:void 0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:this.getListCssClass()},r.a.createElement(L,{searchQuery:this.state.searchQuery}),this.renderTaskNotesFilters(),this.renderList(),r.a.createElement(T,{showLoadMoreButton:this.state.hasMorePages,showSpinner:this.state.isLoadingMorePages,handleLoadMoreClick:this.handleLoadMoreClick.bind(this)}))}},{key:"renderTaskNotesFilters",value:function(){if("task_notes"===this.props.collection)return r.a.createElement("div",{className:"view-filter"},r.a.createElement("select",{onChange:this.handleTaskNoteFilterChanged.bind(this)},r.a.createElement("option",{value:""},"Show all"),r.a.createElement("option",{value:"todo"},"Show todos")))}},{key:"renderList",value:function(){var e=this;return this.state.searchQuery&&0===this.state.notes.length?this.renderEmptyListItem():this.state.notes.map(function(t){return e.renderListItem(t)})}},{key:"renderEmptyListItem",value:function(){return r.a.createElement("div",null,"There's nothing\u2026")}},{key:"renderListItem",value:function(e){return r.a.createElement("div",{className:this.getListItemCssClass(e),key:e.uid,onClick:this.handleNoteClick.bind(this,e)},this.renderNotePicture(e),r.a.createElement("div",{className:"list-item-content"},r.a.createElement("h4",{className:"list-item-heading"},e.title),r.a.createElement("div",{className:"list-item-meta tooltip-top","data-tooltip":O.a.prettyPrint(e.updatedAt,{showTime:!0})},O.a.relativeTime(e.updatedAt))),r.a.createElement("div",{className:"list-item-actions"},r.a.createElement("button",{name:"archive-note",className:"icon",onClick:this.props.handleArchiveNoteClick.bind(this,e)},r.a.createElement(F,null)),r.a.createElement("button",{name:"delete-note",className:"icon",onClick:this.props.handleDeleteNoteClick.bind(this,e)},r.a.createElement(K,null))))}},{key:"getListItemCssClass",value:function(e){var t="card list-item";return this.isActiveNote(e)&&(t+=" active"),t}},{key:"isActiveNote",value:function(e){return e.uid===this.props.activeNoteUid}},{key:"getListCssClass",value:function(){if(!this.props.showList)return"hidden-sm"}},{key:"componentDidUpdate",value:function(){this.listNeedsUpdate&&(this.listNeedsUpdate=!1,this.updateList())}},{key:"componentWillReceiveProps",value:function(e){!this.state.isSynced&&e.isSynced&&!1!==e.listNeedsUpdate&&(this.listNeedsUpdate=!0),this.state.searchQuery!==e.searchQuery&&(this.listNeedsUpdate=!0),this.props.collection!==e.collection&&(this.listNeedsUpdate=!0),this.setState({isSynced:e.isSynced,searchQuery:e.searchQuery})}},{key:"handleNoteClick",value:function(e,t){this.props.handleNoteClick(e,t)}},{key:"handleLoadMoreClick",value:function(e){var t=this;this.setState({isLoadingMorePages:!0}),this.setState({currentPage:this.state.currentPage+1},function(){t.updateList()})}},{key:"handleTaskNoteFilterChanged",value:function(e){var t=this;this.setState({filter:e.target.value},function(){t.updateList()})}},{key:"updateList",value:function(){this.updateListRequest&&this.updateListRequest.controller.abort();var e={search:this.state.searchQuery,page:this.state.currentPage};this.state.filter&&(e["filters[]"]=this.state.filter),this.updateListRequest=Object(p.b)("/api/".concat(this.props.collection),"GET",e),this.executeUpdateListRequest()}},{key:"executeUpdateListRequest",value:function(){var e=this;this.updateListRequest.promise.then(function(t){var n=t.notes.map(function(e){return S.fromAttributes(e)});e.setState({notes:n,currentPage:t.current_page,hasMorePages:t.has_more_pages,isLoadingMorePages:!1})}).catch(function(t){e.setState({isLoadingMorePages:!1}),j.a.show("Watch out, the list is not up to date."),console.error("url: ",e.props.url,"error: ",t.toString())})}},{key:"getPreviewImageUrl",value:function(e){var t=e.content.match(/<img.*? src=['"]([^'"]+)['"].*?>/);return t?t[1]:null}},{key:"renderNotePicture",value:function(e){var t=this.getPreviewImageUrl(e)||_.a,n={backgroundImage:"url(".concat(t,")"),backgroundRepeat:"no-repeat",backgroundSize:"cover"};return r.a.createElement("div",{style:n,className:"list-item-picture"})}}]),t}(a.Component)),G=n(2),X=n.n(G),$=n(36),Z=n.n($),ee=n(37),te=n.n(ee),ne=n(38),ae=n.n(ne),re=n(39),ie=n.n(re),se=n(40),oe=n.n(se),ce=n(41),le=n.n(ce),ue=n(42),he=n.n(ue),de=n(43),fe=n.n(de),ge=n(44),ve=n.n(ge),pe=n(45),me=n.n(pe),be=n(46),ye=n.n(be),ke=n(47),Ee=n.n(ke),Oe=n(48),we=n.n(Oe),Se=n(49),je=n.n(Se),Le=n(50),Ce=n.n(Le),Ne=n(51),xe=n.n(Ne),Pe=n(52),Ae=n.n(Pe),Me=n(53),Ie=n.n(Me),Te=n(54),Re=n.n(Te),_e=n(55),De=n.n(_e),Ue=n(56),He=n.n(Ue),Be=n(57),ze=n.n(Be),Fe=n(58),Qe=n.n(Fe),We=n(59),qe=n.n(We),Je=n(60),Ve=n.n(Je),Ke=n(61),Ye=n.n(Ke),Ge=n(62),Xe=n.n(Ge),$e=n(63),Ze=n.n($e),et=n(64),tt=n.n(et),nt=n(65),at=n.n(nt),rt=n(66),it=n.n(rt),st=n(67),ot=n.n(st),ct=n(68),lt=n.n(ct),ut=n(69),ht=n.n(ut),dt=n(70),ft=n.n(dt),gt=n(71),vt=n.n(gt),pt=n(72),mt=n.n(pt),bt=n(73),yt=n.n(bt),kt=n(74),Et=n.n(kt),Ot=n(75),wt=n.n(Ot),St=n(76),jt=n.n(St),Lt=n(77),Ct=n.n(Lt),Nt=n(78),xt=n.n(Nt),Pt=n(79),At=n.n(Pt),Mt=n(80),It=n.n(Mt),Tt=n(81),Rt=n.n(Tt),_t=n(82),Dt=n.n(_t),Ut=n(83),Ht=n.n(Ut),Bt=n(84),zt=n.n(Bt),Ft=n(85),Qt=n.n(Ft),Wt=n(86),qt=n.n(Wt),Jt=n(87),Vt=n.n(Jt),Kt=n(88),Yt=n.n(Kt),Gt=n(89),Xt=n.n(Gt),$t=n(90),Zt=n.n($t),en=n(91),tn=n.n(en),nn=n(92),an=n.n(nn),rn=n(93),sn=n.n(rn),on=n(94),cn=n.n(on),ln=n(95),un=n.n(ln),hn=n(96),dn=n.n(hn),fn=n(97),gn=n.n(fn),vn=n(98),pn=n.n(vn),mn=n(99),bn=n.n(mn),yn=n(100),kn=n.n(yn);n(130);X.a.registerLanguage("asciidoc",Z.a),X.a.registerLanguage("bash",te.a),X.a.registerLanguage("basic",ae.a),X.a.registerLanguage("clean",ie.a),X.a.registerLanguage("clojure",oe.a),X.a.registerLanguage("cmake",le.a),X.a.registerLanguage("coffeescript",he.a),X.a.registerLanguage("cpp",fe.a),X.a.registerLanguage("crystal",ve.a),X.a.registerLanguage("csharp",me.a),X.a.registerLanguage("css",ye.a),X.a.registerLanguage("d",Ee.a),X.a.registerLanguage("dart",we.a),X.a.registerLanguage("diff",je.a),X.a.registerLanguage("dockerfile",Ce.a),X.a.registerLanguage("ebnf",xe.a),X.a.registerLanguage("elixir",Ae.a),X.a.registerLanguage("elm",Ie.a),X.a.registerLanguage("erb",Re.a),X.a.registerLanguage("erlang",De.a),X.a.registerLanguage("fsharp",He.a),X.a.registerLanguage("gherkin",ze.a),X.a.registerLanguage("go",Qe.a),X.a.registerLanguage("gradle",qe.a),X.a.registerLanguage("groovy",Ve.a),X.a.registerLanguage("haml",Ye.a),X.a.registerLanguage("handlebars",Xe.a),X.a.registerLanguage("htmlbars",Ze.a),X.a.registerLanguage("http",tt.a),X.a.registerLanguage("ini",at.a),X.a.registerLanguage("java",it.a),X.a.registerLanguage("javascript",ot.a),X.a.registerLanguage("json",lt.a),X.a.registerLanguage("kotlin",ht.a),X.a.registerLanguage("less",ft.a),X.a.registerLanguage("lisp",vt.a),X.a.registerLanguage("llvm",mt.a),X.a.registerLanguage("makefile",yt.a),X.a.registerLanguage("markdown",Et.a),X.a.registerLanguage("mathematica",wt.a),X.a.registerLanguage("matlab",jt.a),X.a.registerLanguage("nginx",Ct.a),X.a.registerLanguage("objectivec",xt.a),X.a.registerLanguage("perl",At.a),X.a.registerLanguage("pgsql",It.a),X.a.registerLanguage("php",Rt.a),X.a.registerLanguage("plaintext",Dt.a),X.a.registerLanguage("powershell",Ht.a),X.a.registerLanguage("prolog",zt.a),X.a.registerLanguage("properties",Qt.a),X.a.registerLanguage("python",qt.a),X.a.registerLanguage("r",Vt.a),X.a.registerLanguage("ruby",Yt.a),X.a.registerLanguage("rust",Xt.a),X.a.registerLanguage("scala",Zt.a),X.a.registerLanguage("scss",tn.a),X.a.registerLanguage("shell",an.a),X.a.registerLanguage("sql",sn.a),X.a.registerLanguage("stylus",cn.a),X.a.registerLanguage("swift",un.a),X.a.registerLanguage("latex",dn.a),X.a.registerLanguage("typescript",gn.a),X.a.registerLanguage("vim",pn.a),X.a.registerLanguage("xml",bn.a),X.a.registerLanguage("yaml",kn.a),window.hljs=X.a;var En=n(13),On=n.n(En),wn=(n(150),n(136),n(137),function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).state={note:a.props.note},a.shouldRerender=!0,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.showForm?void 0:"hidden-sm"},r.a.createElement("form",{ref:function(t){return e.formContainerElement=t},onSubmit:this.handleFormSubmit},this.renderTitle(),this.renderContent()))}},{key:"renderTitle",value:function(){var e=this;return r.a.createElement("input",{type:"text",value:this.state.note.title,onChange:this.handleTitleChange.bind(this),placeholder:"Title",ref:function(t){return e.titleElement=t}})}},{key:"renderContent",value:function(){var e=this;return r.a.createElement("div",{ref:function(t){return e.contentContainerElement=t}})}},{key:"handleFormSubmit",value:function(e){return e.preventDefault(),!1}},{key:"handleTitleChange",value:function(){this.shouldRerender=!0;var e=this.state.note;e.title=this.titleElement.value,this.setState({note:e},this.handleChange)}},{key:"handleContentChange",value:function(){this.shouldRerender=!1;var e=this.state.note;e.content=this.contentElement.innerHTML,this.setState({note:e},this.handleChange)}},{key:"handleChange",value:function(){this.props.handleChange(this.state.note)}},{key:"componentDidMount",value:function(){var e=this;this.focusTitleFieldIfNewNote(),this.renderEditor(),this.noteUpdateSubscription=k.a.subscribe("note.update",function(t){e.titleElement.value=t.title,e.handleTitleChange(),e.editor.pasteHTML(t.content)})}},{key:"componentDidUpdate",value:function(){this.editor.off("text-change"),this.editor.setText(""),this.contentElement.innerHTML=this.state.note.content,this.editor.history.clear(),this.editor.update(),this.editor.on("text-change",this.handleContentChange.bind(this))}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.note.uid!==this.state.note.uid&&(this.shouldRerender=!0,this.setState({note:e.note},function(){return t.focusTitleFieldIfNewNote()}))}},{key:"componentWillUnmount",value:function(){this.noteUpdateSubscription.remove()}},{key:"shouldComponentUpdate",value:function(e,t){return this.shouldRerender}},{key:"renderEditor",value:function(){this.editor=new On.a(this.contentContainerElement,{theme:"snow",modules:{syntax:!0,toolbar:[[{header:[1,2,!1]}],["bold","italic","strike"],[{color:[]},{background:[]}],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"},"task-list",{indent:"-1"},{indent:"+1"}],["link","image"],["clean"]],"task-list":!0}}),this.contentElement=this.contentContainerElement.querySelector(".ql-editor")}},{key:"focusTitleFieldIfNewNote",value:function(){this.state.note.isNew()&&this.titleElement.focus()}}]),t}(a.Component)),Sn=n(28),jn=function(){function e(t,n){Object(o.a)(this,e),this.path=t.path,this.history=n}return Object(c.a)(e,[{key:"setNew",value:function(){this.history.push(this.path)}},{key:"setEdit",value:function(e){var t=this.path;t.includes(":id")||(t="".concat(t,"/:id"));var n=Object(Sn.a)(t,{id:e.uid});this.history.location.pathname!==n&&this.history.push(n)}},{key:"setBrowserTitle",value:function(e){e&&e.title?document.title="".concat(e.title," | Mykonote"):document.title="Mykonote"}}]),e}(),Ln=n(18);function Cn(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xn=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,null,[{key:"set",value:function(t){localStorage.setItem(e._getKey(t),t.toJson())}},{key:"get",value:function(t){return localStorage.getItem(e._getKey(t))}},{key:"eachNote",value:function(t){var n,a=Cn(e._getLocalStorageKeys());try{for(a.s();!(n=a.n()).done;){var r=n.value,i=localStorage.getItem(r);t(JSON.parse(i),i)}}catch(s){a.e(s)}finally{a.f()}}},{key:"remove",value:function(t){localStorage.removeItem(e._getKey(t))}},{key:"isEmpty",value:function(){return 0===e._getLocalStorageKeys().length}},{key:"_getLocalStorageKeys",value:function(){for(var t=[],n=localStorage.length,a=0;a<n;++a){var r=localStorage.key(a);r.startsWith(e.KEY_PREFIX)&&t.push(r)}return t}},{key:"_getKey",value:function(t){return e.KEY_PREFIX+t.uid}},{key:"KEY_PREFIX",get:function(){return"note-"}}]),e}(),Pn=function(){function e(t){Object(o.a)(this,e),this.onServerSyncCallback=t,this.setSyncStatus()}return Object(c.a)(e,[{key:"startPolling",value:function(){this.interval=setInterval(this.syncToServer.bind(this),e.POLLING_INTERVAL)}},{key:"stopPolling",value:function(){clearInterval(this.interval)}},{key:"setChange",value:function(e){this.setSyncStatus(!1),xn.set(e)}},{key:"syncToServer",value:function(){var e=this;if(!this.syncInProgress){this.syncInProgress=!0;var t=[];xn.eachNote(function(n,a){var r="/api/notes/"+n.uid,i=Object(p.a)(r,"PUT",Object(p.c)(n,"note"));t.push(i),i.then(function(t){return e.ajaxDone(n,a,S.fromAttributes(t))}).catch(function(t){return e.ajaxFail(t,r)})}),Promise.allSettled(t).then(function(){return e.syncInProgress=!1})}}},{key:"setSyncStatus",value:function(e,t){void 0===e&&(e=xn.isEmpty()),window.onbeforeunload=e?void 0:function(){return"Behold! You have unsynchronized changes. If you leave the page now, your changes won't be saved to the server.\n(Your data won't be lost, but it will only remain locally in your browser)"},this.onServerSyncCallback({isSynced:e,note:t})}},{key:"ajaxDone",value:function(e,t,n){var a=xn.get(e);if(t===a)xn.remove(e);else{var r=S.fromAttributes(JSON.parse(a));r.serverUpdatedAt=n.serverUpdatedAt,xn.set(r)}this.setSyncStatus(void 0,n)}},{key:"ajaxFail",value:function(e,t){window.navigator.onLine&&(401===e.status?j.a.show('Your session has expired. You need to <a href="/" class="alert-link">sign in</a> again.<br>Your changes won\'t be lost, once you\'re signed in they will be saved to the server.'):422===e.status?j.a.show(e.responseJson.errors.join("<br>")):(j.a.show("Something went sideways: "+e.message),console.error("url: ",t,"error: ",e.toString())))}}],[{key:"POLLING_INTERVAL",get:function(){return 3e3}}]),e}(),An=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).state={show:!!e.show},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Math.random().toString(16).slice(-12);return r.a.createElement("div",{className:"modal"},r.a.createElement("input",{id:e,type:"checkbox",checked:this.state.show,onChange:function(){}}),r.a.createElement("label",{htmlFor:e,className:"overlay"}),r.a.createElement("article",null,r.a.createElement("header",null,r.a.createElement("h3",null,this.props.title),r.a.createElement("label",{htmlFor:e,className:"close",onClick:this.handleCancelButtonClick.bind(this)},"\xd7")),r.a.createElement("section",{className:"content",dangerouslySetInnerHTML:{__html:this.props.text}}),r.a.createElement("footer",null,r.a.createElement("button",{className:"button",onClick:this.handleOkButtonClick.bind(this)},"Ok"),r.a.createElement("label",{htmlFor:e,className:"button dangerous",onClick:this.handleCancelButtonClick.bind(this)},"Cancel"))))}},{key:"componentWillReceiveProps",value:function(e){this.setState({show:!!e.show})}},{key:"handleOkButtonClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.handleConfirmed(!0)}},{key:"handleCancelButtonClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.handleConfirmed(!1)}}]),t}(a.Component),Mn=(n(143),function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).state={isSynced:e.isSynced},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({isSynced:e.isSynced})}},{key:"render",value:function(){return this.state.isSynced?r.a.createElement("div",{className:"save-state saved"},"Saved"):r.a.createElement("div",{className:"save-state saving"},"Saving")}}]),t}(a.Component));function In(){return(In=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Tn(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Rn=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),_n=r.a.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),Dn=function(e){var t=e.svgRef,n=Tn(e,["svgRef"]);return r.a.createElement("svg",In({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),Rn,_n)},Un=r.a.forwardRef(function(e,t){return r.a.createElement(Dn,In({svgRef:t},e))}),Hn=(n.p,n(144),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"action-bar"},this.props.left?this.props.left:r.a.createElement("div",{className:"icon big invisible"}),r.a.createElement(Mn,{isSynced:this.props.isSynced}),r.a.createElement("button",{name:"new",onClick:this.props.handleNewClicked.bind(this),className:"icon big"},r.a.createElement(Un,null)))}}]),t}(a.Component));function Bn(){return(Bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zn(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Fn=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),Qn=r.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),Wn=function(e){var t=e.svgRef,n=zn(e,["svgRef"]);return r.a.createElement("svg",Bn({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),Fn,Qn)},qn=r.a.forwardRef(function(e,t){return r.a.createElement(Wn,Bn({svgRef:t},e))}),Jn=(n.p,function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="icon big invisible-lg";return this.props.showList&&(e+=" invisible"),r.a.createElement(Hn,Object.assign({left:r.a.createElement("button",{onClick:this.props.handleShowListClicked.bind(this),className:e},r.a.createElement(qn,null))},this.props))}}]),t}(a.Component)),Vn=n(17),Kn=function(e){function t(e,n){var a;Object(o.a)(this,t);var r=(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).props.match;return e.note?a.initStateFromNote(e.note):r.params.id?a.initStateFromNoteId(r.params.id):a.state=Object(m.a)({},a.getNewNoteAttributes(),{showList:!0}),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.renderHeaderBar(),this.renderContent(),r.a.createElement(An,{title:"Archive",text:"Are you sure you want to archive this note?",show:this.state.showArchiveDialog,handleConfirmed:this.state.handleArchiveDialogConfirmed}),r.a.createElement(An,{title:"Delete",text:"Are you sure you want to delete this note?",show:this.state.showDeleteDialog,handleConfirmed:this.state.handleDeleteDialogConfirmed}))}},{key:"componentDidMount",value:function(){var e=this;this.autoSave=new Pn(this.handleServerSync.bind(this)),this.autoSave.startPolling(),this.noteCreateSubscription=k.a.subscribe("note.create",function(t){e.setNewNote(function(){k.a.publish("note.update",t)})}),this.noteNewSubscription=k.a.subscribe("note.new",function(t){e.setNewNote()})}},{key:"componentWillUnmount",value:function(){this.noteCreateSubscription.remove(),this.noteNewSubscription.remove(),this.autoSave.stopPolling()}},{key:"renderHeaderBar",value:function(){return r.a.createElement(Ln.a,{isLoggedIn:!0,handleSearchEnter:this.handleSearchEnter.bind(this),handleSearchCleared:this.handleSearchCleared.bind(this)})}},{key:"renderContent",value:function(){return r.a.createElement("main",null,r.a.createElement(Vn.a,null),r.a.createElement(Jn,{showList:this.state.showList,isSynced:this.state.isSynced,handleShowListClicked:this.handleShowListClicked.bind(this),handleNewClicked:this.handleNewNoteClicked.bind(this)}),r.a.createElement("div",{className:"flex one two-900"},r.a.createElement("div",{className:"full third-900 fourth-1200"},r.a.createElement(Y,{activeNoteUid:this.state.note.uid,isSynced:this.state.isSynced,showList:this.state.showList,searchQuery:this.state.searchQuery,collection:this.props.collection,handleNoteClick:this.handleNoteClick.bind(this),handleDeleteNoteClick:this.handleDeleteNoteClick.bind(this),handleArchiveNoteClick:this.handleArchiveNoteClick.bind(this)})),r.a.createElement("div",{className:"full two-third-900 three-fourth-1200 padding-left-xl"},r.a.createElement(wn,{note:this.state.note,handleChange:this.handleEditChange.bind(this),showForm:!this.state.showList}))))}},{key:"initStateFromNote",value:function(e){this.state={note:S.fromAttributes(e)},new jn(this.props.match,this.props.history).setBrowserTitle(e)}},{key:"initStateFromNoteId",value:function(e){var t=this;this.state=Object(m.a)({showList:!1},this.getNewNoteAttributes()),Object(p.a)("/api/notes/".concat(e)).then(function(e){var n=S.fromAttributes(e.note);t.setState({showList:!1,note:n},function(){return new jn(t.props.match,t.props.history).setBrowserTitle(n)})}).catch(function(){j.a.show("While trying to load the note the internet broke down (or something else failed, maybe the note could not be found)")})}},{key:"handleNoteClick",value:function(e,t){t.preventDefault(),this.setState({note:e,showList:!1});var n=new jn(this.props.match,this.props.history);n.setEdit(e),n.setBrowserTitle(e)}},{key:"handleDeleteNoteClick",value:function(e,t){var n=this;t.preventDefault(),t.stopPropagation();this.setState({showDeleteDialog:!0,handleDeleteDialogConfirmed:function(t){n.setState({showDeleteDialog:!1}),t&&(n.setState({isSynced:!1}),n.deleteNote(e))}.bind(this)})}},{key:"handleArchiveNoteClick",value:function(e,t){var n=this;t.preventDefault(),t.stopPropagation();this.setState({showArchiveDialog:!0,handleArchiveDialogConfirmed:function(t){n.setState({showArchiveDialog:!1}),t&&(e.setArchived(),n.handleEditChange(e),n.setNewNote())}.bind(this)})}},{key:"handleNewNoteClicked",value:function(){this.setNewNote()}},{key:"handleShowListClicked",value:function(){var e=this;this.setNewNote(function(){return e.setState({showList:!0})})}},{key:"handleEditChange",value:function(e){new jn(this.props.match,this.props.history).setEdit(e),this.autoSave.setChange(e)}},{key:"handleServerSync",value:function(e){var t={isSynced:e.isSynced,listNeedsUpdate:!0};e.note&&this.state.note.uid===e.note.uid&&(t.note=this.state.note,t.note.serverUpdatedAt=e.note.serverUpdatedAt),this.setState(t),e.isSynced&&new jn(this.props.match,this.props.history).setBrowserTitle(this.state.note)}},{key:"handleSearchEnter",value:function(e){this.setState({searchQuery:e,showList:!0})}},{key:"handleSearchCleared",value:function(){this.setState({searchQuery:""})}},{key:"getNewNoteAttributes",value:function(){return{note:new S}}},{key:"setNewNote",value:function(e){this.setState(Object(m.a)({},this.getNewNoteAttributes(),{showList:!1}),e);var t=new jn(this.props.match,this.props.history);t.setNew(),t.setBrowserTitle()}},{key:"deleteNote",value:function(e){var t=this;Object(p.a)("/api/notes/".concat(e.uid),"DELETE").then(function(n){xn.remove(e),t.state.note.uid===e.uid&&t.setNewNote(),t.setState({isSynced:!0,listNeedsUpdate:!0})}).catch(function(n){var a="Oh my, the note could not be deleted.";window.navigator.onLine||(a+="<br>Please check your internet connection (Apologies, deleting in offline mode is not yet suppported)."),j.a.show(a),console.error("note.uid: ",e.uid,"error: ",n.toString()),t.setState({isSynced:!0,listNeedsUpdate:!1})}).finally(function(){})}}]),t}(a.Component),Yn=(n(146),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("label",{className:"task"},r.a.createElement("input",{type:"checkbox",checked:this.props.task.done,onChange:this.handleTaskChecked.bind(this,this.props.note,this.props.task)}),r.a.createElement("span",{className:"checkable"},this.props.task.title))}},{key:"handleTaskChecked",value:function(e){this.props.handleTaskChecked(this.props.note,Object(m.a)({},this.props.task,{done:!this.props.task.done}),e)}}]),t}(a.Component));function Gn(){return(Gn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xn(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var $n=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),Zn=r.a.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),ea=function(e){var t=e.svgRef,n=Xn(e,["svgRef"]);return r.a.createElement("svg",Gn({height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000",ref:t},n),$n,Zn)},ta=r.a.forwardRef(function(e,t){return r.a.createElement(ea,Gn({svgRef:t},e))}),na=(n.p,function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).state={showDone:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"card"},r.a.createElement("header",null,this.props.note.title),this.renderTodo(),this.renderDone())}},{key:"renderTodo",value:function(){var e=this,t=this.props.note.tasks.filter(function(e){return!e.done});return r.a.createElement("div",null,t.length>0?r.a.createElement("footer",null,t.map(function(t){return e.renderTask(t)})):null)}},{key:"renderDone",value:function(){var e=this,t=this.props.note.tasks.filter(function(e){return e.done});return r.a.createElement("div",null,t.length>0?r.a.createElement("footer",null,r.a.createElement("button",{name:"toggle-done",className:"icon left-aligned full-width",onClick:function(){return e.setState({showDone:!e.state.showDone})}},this.state.showDone?r.a.createElement(ta,null):r.a.createElement(I,null)),r.a.createElement("div",{className:this.state.showDone?null:"collapsed"},t.map(function(t){return e.renderTask(t)}))):null)}},{key:"renderTask",value:function(e){return r.a.createElement(Yn,{key:e.id,note:this.props.note,task:e,handleTaskChecked:this.props.handleTaskChecked.bind(this)})}}]),t}(a.Component)),aa=function(e){function t(e,n){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e,n))).state={notes:[],currentPage:1,searchQuery:void 0,filter:"todo",hasMorePages:!1,isLoadingMorePages:!0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(Ln.a,{isLoggedIn:!0,handleSearchEnter:this.handleSearchEnter.bind(this),handleSearchCleared:this.handleSearchCleared.bind(this)}),r.a.createElement("main",null,r.a.createElement(Vn.a,null),r.a.createElement(Hn,{handleNewClicked:function(){return e.props.history.push("/notes")},isSynced:this.state.isSynced}),r.a.createElement("div",{className:"flex one"},r.a.createElement("div",{className:"full"},r.a.createElement(L,{searchQuery:this.state.searchQuery}),r.a.createElement("div",{className:"view-filter"},r.a.createElement("select",{name:"view-filter",onChange:this.handleFilterChanged.bind(this)},r.a.createElement("option",{value:"todo"},"Show todos"),r.a.createElement("option",{value:""},"Show all"))),this.renderEmpty(),this.state.notes.map(function(t){return r.a.createElement(na,{key:t.uid,note:t,handleTaskChecked:e.handleTaskChecked.bind(e)})}),r.a.createElement(T,{showLoadMoreButton:this.state.hasMorePages,showSpinner:this.state.isLoadingMorePages,handleLoadMoreClick:this.handleLoadMoreClick.bind(this)})))))}},{key:"componentDidMount",value:function(){this.autoSave=new Pn(this.handleServerSync.bind(this)),this.autoSave.startPolling()}},{key:"componentWillUnmount",value:function(){this.autoSave.stopPolling()}},{key:"renderEmpty",value:function(){if(!(this.state.notes.length>0))return r.a.createElement("div",null,"There's nothing\u2026")}},{key:"handleTaskChecked",value:function(e,t,n){var a=this.state.notes.find(function(t){return t.uid===e.uid}),r=a.tasks.findIndex(function(e){return e.id===t.id});a.tasks[r]=t;var i=document.createElement("div");i.innerHTML=e.content,i.querySelector('[data-task-id="'.concat(t.id,'"]')).classList.toggle("checked"),a.content=i.innerHTML,this.autoSave.setChange(S.fromAttributes(a))}},{key:"handleServerSync",value:function(e){e.isSynced&&this.fetchTasks(),this.setState({isSynced:e.isSynced})}},{key:"handleSearchEnter",value:function(e){var t=this;this.setState({searchQuery:e},function(){t.fetchTasks()})}},{key:"handleSearchCleared",value:function(){var e=this;this.setState({searchQuery:""},function(){e.fetchTasks()})}},{key:"handleFilterChanged",value:function(e){var t=this;this.setState({filter:e.target.value},function(){t.fetchTasks()})}},{key:"handleLoadMoreClick",value:function(e){var t=this;this.setState({isLoadingMorePages:!0}),this.setState({currentPage:this.state.currentPage+1},function(){t.fetchTasks()})}},{key:"fetchTasks",value:function(){var e=this,t={search:this.state.searchQuery,page:this.state.currentPage};this.state.filter&&(t["filters[]"]=this.state.filter),Object(p.a)("/api/task_notes","GET",t).then(function(t){e.setState({notes:t.notes,hasMorePages:t.has_more_pages,isLoadingMorePages:!1})}).catch(function(t){j.a.show("Fetching the tasks failed."),console.error("url: ",e.props.url,"error: ",t.toString())})}}]),t}(a.Component),ra=(n(147),n(148),r.a.lazy(function(){return n.e(3).then(n.bind(null,159))})),ia=r.a.lazy(function(){return n.e(4).then(n.bind(null,160))}),sa=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={isLoggedIn:null},n.setIsLoggedIn(),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement("div",null,this.renderLoggedIn(),this.renderLoggedOut()))}},{key:"onLoginSuccess",value:function(){this.setState({isLoggedIn:!0})}},{key:"setIsLoggedIn",value:function(){var e=this;Object(p.a)("/users/is_authenticated").then(function(){return e.onLoginSuccess()}).catch(function(){return e.setState({isLoggedIn:!1})})}},{key:"renderLoggedIn",value:function(){var e=this;if(!0===this.state.isLoggedIn)return r.a.createElement(f.a,null,r.a.createElement(g.a,{path:["/notes/:id","/notes"],render:function(t){return e.renderNoteEdit(t,"notes")}}),r.a.createElement(g.a,{path:["/task-notes/:id","/task-notes"],render:function(t){return e.renderNoteEdit(t,"task_notes")}}),r.a.createElement(g.a,{path:["/tasks/:id","/tasks"],render:function(e){return r.a.createElement(aa,e)}}),r.a.createElement(v.a,{from:"/",to:"/notes"}))}},{key:"renderLoggedOut",value:function(){var e=this;if(!1===this.state.isLoggedIn)return r.a.createElement(f.a,null,r.a.createElement(g.a,{path:"/register",render:function(t){return r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(ia,Object.assign({onLoginSuccess:e.onLoginSuccess.bind(e)},t)))}}),r.a.createElement(g.a,{path:"/login",render:function(t){return r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(ra,{onLoginSuccess:e.onLoginSuccess.bind(e),alwaysRememberMe:window.ALWAYS_REMEMBER_ME}))}}),r.a.createElement(v.a,{to:"/login"}))}},{key:"renderNoteEdit",value:function(e,t){return r.a.createElement(Kn,Object.assign({},e,{collection:t}))}}]),t}(a.Component),oa=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ca(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var la=n(19);window.EventHive=k.a,window.NoticeFlash=la.a,window.AlertFlash=j.a,s.a.render(r.a.createElement(sa,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat(".","/service-worker.js");oa?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ca(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ca(e)})}}()},17:function(e,t,n){"use strict";var a=n(3),r=n(4),i=n(7),s=n(5),o=n(6),c=n(0),l=n.n(c),u=n(19),h=n(9),d=(n(145),function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(u.a,null),l.a.createElement(h.a,null))}}]),t}(c.Component));t.a=d},18:function(e,t,n){"use strict";var a=n(3),r=n(4),i=n(7),s=n(5),o=n(6),c=n(0),l=n.n(c),u=n(153),h=n(152),d=n(11),f=n(9),g=n(32);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),b=l.a.createElement("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"}),y=function(e){var t=e.svgRef,n=p(e,["svgRef"]);return l.a.createElement("svg",v({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),m,b)},k=l.a.forwardRef(function(e,t){return l.a.createElement(y,v({svgRef:t},e))}),E=(n.p,function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("button",{name:"logout",onClick:this.handleClicked.bind(this),className:"icon-lg big pseudo"},l.a.createElement(k,null),l.a.createElement("span",{className:"icon-lg-text"},"Logout"))}},{key:"handleClicked",value:function(e){e.preventDefault(),Object(d.a)("/users/sign_out","DELETE").then(function(){window.location.reload()}).catch(function(){f.a.show("Apologies, logging out did not happen.")}).finally(g.a)}}]),t}(c.Component)),O=Object(h.a)(E),w=n(29),S=n(21),j=n(8);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var N=l.a.createElement("circle",{fill:"#008bce",cx:46.28,cy:46.28,r:46.28}),x=l.a.createElement("path",{fill:"#fff",d:"M44.84 43.38a2.9 2.9 0 1 0 2.9 2.9 2.9 2.9 0 0 0-2.9-2.9z"}),P=l.a.createElement("path",{fill:"#fff",d:"M46.33 34.07A153.13 153.13 0 0 0 62.48 48.6a7.53 7.53 0 0 0-1.78 2 5.42 5.42 0 0 0 .24 6.33 6.65 6.65 0 0 0 5.24 2.52 5.14 5.14 0 0 0 4-2 5.91 5.91 0 0 0 1.29-4.58 6.07 6.07 0 0 0-.63-1.9 9.3 9.3 0 0 1 5.29 3.91 10.11 10.11 0 0 1 1.35 7.82c-.95 3.12-2.28 5.68-5.85 7.22-9.31 4-17.49-3.8-21.45-8.65-.69-.85-1.4-1.59-2.25-.89s-.51 1.68.1 2.59a26.32 26.32 0 0 0 10.55 9.65 16.44 16.44 0 0 0 13.94.79 14.39 14.39 0 0 0 8.41-9.29 13.43 13.43 0 0 0-1.44-10.74 13.64 13.64 0 0 0-8.92-6.5 11 11 0 0 0-3.92-.11 143.91 143.91 0 0 1-16.53-14.48c5.13-3.33 6.21-7.84 5.7-17.9l-.15-2.84-2.62 1.12c-6.17 2.63-9.77 5.82-10.59 10.48a13.11 13.11 0 0 0 1 7.58 23.71 23.71 0 0 1-6.88.23c-.18-6.56-2.22-15.45-12.79-18.53l-2.61-.88v2.75c.14 14.12 5.55 19.06 11.16 20.06h.23v.19c-.13 5-5 27.79-18.86 44.59q1.41 1.4 2.95 2.68C30.83 65 36.22 41.76 36.54 34.92a24.41 24.41 0 0 0 9.79-.85zm19.41 17.79a2.42 2.42 0 1 1-2.42 2.42 2.42 2.42 0 0 1 2.42-2.42zm-19.36-28a11.09 11.09 0 0 1 6.46-7.67c.44 7.76-2.18 11.32-5.49 13.15l-.19-.21c-.69-.82-1.1-3.53-.78-5.3zm-22.43-8.18c7.67 2.9 8.47 9.58 8.66 14.73-3.63-.94-7.85-5.58-8.66-14.76z"}),A=function(e){var t=e.svgRef,n=C(e,["svgRef"]);return l.a.createElement("svg",L({viewBox:"0 0 92.57 92.57",ref:t},n),N,x,P)},M=l.a.forwardRef(function(e,t){return l.a.createElement(A,L({svgRef:t},e))}),I=(n.p,function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e,n))).state={showSpinner:!1},r}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement(w.a,{to:"/",className:"brand"},this.state.showSpinner?l.a.createElement("div",{className:"logo"},l.a.createElement(S.a,null)):l.a.createElement(M,{className:"logo"}))}},{key:"componentDidMount",value:function(){this.subscribeSpinner()}},{key:"componentWillUnmount",value:function(){this.unsubscribeSpinner()}},{key:"subscribeSpinner",value:function(){var e=this;this.spinnerSubscription=j.a.subscribe("spinner.toggle",function(t){e.setState({showSpinner:t.show})})}},{key:"unsubscribeSpinner",value:function(){this.spinnerSubscription.remove()}}]),t}(c.Component)),T=n(102);function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var D=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),U=l.a.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),H=function(e){var t=e.svgRef,n=_(e,["svgRef"]);return l.a.createElement("svg",R({height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000",ref:t},n),D,U)},B=l.a.forwardRef(function(e,t){return l.a.createElement(H,R({svgRef:t},e))}),z=(n.p,n(141),function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e,n))).state={value:"",isActive:!1},r.handleSearchEnterDebounced=Object(T.a)(500,r.handleSearchEnterDebounced),r}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"search vertically-aligned"},l.a.createElement("input",{type:"text",className:"search-input",name:"search",value:this.state.value,onChange:this.handleSearchEnter.bind(this),onFocus:function(){return e.setState({isActive:!0})},onBlur:function(){return e.setState({isActive:!1})},ref:function(t){return e.searchInput=t}}),""!==this.state.value&&l.a.createElement("button",{type:"button",className:"search-clear",onClick:this.handleSearchCleared.bind(this)},"\xd7"),!this.state.isActive&&""===this.state.value&&l.a.createElement(B,{onClick:function(){return e.searchInput.focus()},className:"search-icon"}))}},{key:"componentDidMount",value:function(){this.subscribeSearch()}},{key:"componentWillUnmount",value:function(){this.unsubscribeSearch()}},{key:"handleSearchEnter",value:function(e){var t=e.target.value;this.setState({value:t},this.handleSearchEnterDebounced)}},{key:"handleSearchEnterDebounced",value:function(){this.props.handleSearchEnter(this.state.value)}},{key:"handleSearchCleared",value:function(e){e.target.blur(),this.setState({value:""}),this.props.handleSearchCleared()}},{key:"subscribeSearch",value:function(){var e=this;this.searchSubscription=j.a.subscribe("search.focus",function(){e.searchInput.focus()})}},{key:"unsubscribeSearch",value:function(){this.searchSubscription.remove()}}]),t}(c.Component));function F(e){if(navigator.webdriver)return!0;var t=localStorage.getItem("feature-".concat(e));return!!JSON.parse(t)}function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function W(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var q=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),J=l.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),V=function(e){var t=e.svgRef,n=W(e,["svgRef"]);return l.a.createElement("svg",Q({height:24,viewBox:"0 0 24 24",width:24,ref:t},n),q,J)},K=l.a.forwardRef(function(e,t){return l.a.createElement(V,Q({svgRef:t},e))}),Y=(n.p,n(142),function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("nav",null,l.a.createElement(I,null),this.props.isLoggedIn&&l.a.createElement(z,{handleSearchEnter:this.props.handleSearchEnter,handleSearchCleared:this.props.handleSearchCleared}),l.a.createElement("input",{id:"bmenug",type:"checkbox",className:"show",ref:function(t){return e.showHamburger=t}}),l.a.createElement("label",{htmlFor:"bmenug",className:"burger pseudo button"},"\u2261"),l.a.createElement("div",{className:"menu"},F("tasks")&&l.a.createElement(u.a,{to:"/notes",className:"button pseudo"},"All notes"),F("tasks")&&l.a.createElement(u.a,{to:"/task-notes",className:"button pseudo"},"Task notes"),F("tasks")&&l.a.createElement(u.a,{to:"/tasks",className:"button pseudo"},"Tasks"),l.a.createElement("button",{className:"icon close-hamburger hidden-lg",onClick:this.handleCloseHamburgerClicked.bind(this)},l.a.createElement(K,null)),this.props.isLoggedIn?l.a.createElement(O,null):null))}},{key:"handleCloseHamburgerClicked",value:function(){this.showHamburger.checked=!1}}]),t}(c.Component));t.a=Y},19:function(e,t,n){"use strict";var a=n(3),r=n(4),i=n(7),s=n(5),o=n(6),c=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"getName",value:function(){return"notice"}},{key:"getAdditionalCssClass",value:function(){return"success"}}]),t}(n(20).a);t.a=c},20:function(e,t,n){"use strict";var a=n(3),r=n(4),i=n(7),s=n(5),o=n(6),c=n(0),l=n.n(c),u=function(e){function t(e,n){var r;return Object(a.a)(this,t),(r=Object(i.a)(this,Object(s.a)(t).call(this,e,n))).state={message:e.message},r}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return this.state.message?l.a.createElement("div",{className:"flex center"},l.a.createElement("div",{className:"hidden-sm"}),l.a.createElement("div",{className:"full third-1000"},l.a.createElement("div",{className:this.getCssClass()},l.a.createElement("footer",{dangerouslySetInnerHTML:{__html:this.state.message}}),l.a.createElement("button",{className:"close icon",type:"button",onClick:this.handleClose.bind(this)},"\xd7"))),l.a.createElement("div",{className:"hidden-sm"})):null}},{key:"getCssClass",value:function(){return["card",this.getAdditionalCssClass()].join(" ")}},{key:"handleClose",value:function(){this.setState({message:null})}},{key:"componentDidMount",value:function(){document.addEventListener(this.constructor.getEventName(),this.handleEvent.bind(this),!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener(this.constructor.getEventName(),this.handleEvent.bind(this),!1)}},{key:"handleEvent",value:function(e){this.setState({message:e.detail.message})}},{key:"getAdditionalCssClass",value:function(){}},{key:"getName",value:function(){}}],[{key:"getEventName",value:function(){return"mykonote.flash."+this.prototype.getName()}},{key:"show",value:function(e){var t=new CustomEvent(this.getEventName(),{detail:{message:e}});document.dispatchEvent(t)}},{key:"clear",value:function(){var e=new CustomEvent(this.getEventName(),{detail:{message:null}});document.dispatchEvent(e)}}]),t}(c.Component);t.a=u},21:function(e,t,n){"use strict";var a=n(0),r=n.n(a);n(113);t.a=function(){return r.a.createElement("svg",{className:"spinner",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("circle",{className:"path",fill:"none",strokeWidth:"6",strokeLinecap:"round",cx:"33",cy:"33",r:"30"}))}},32:function(e,t,n){"use strict";function a(){window.scrollTo({top:0,behavior:"smooth"})}n.d(t,"a",function(){return a})},35:function(e,t,n){e.exports=n.p+"static/media/short_text-24px.0c7dd082.svg"},8:function(e,t,n){"use strict";var a=n(3),r=n(4),i=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"subscribe",value:function(e,t){var n=this;this.topics.hasOwnProperty.call(this.topics,e)||(this.topics[e]=[]);var a=this.topics[e].push(t)-1;return{remove:function(){delete n.topics[e][a]}}}},{key:"publish",value:function(e,t){this.topics.hasOwnProperty.call(this.topics,e)&&this.topics[e].forEach(function(e){e(void 0!==t?t:{})})}},{key:"topics",get:function(){return"undefined"===typeof this._topics&&(this._topics={}),this._topics}}]),e}();t.a=i},9:function(e,t,n){"use strict";var a=n(3),r=n(4),i=n(7),s=n(5),o=n(6),c=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"getName",value:function(){return"alert"}},{key:"getAdditionalCssClass",value:function(){return"warning"}}]),t}(n(20).a);t.a=c}},[[107,1,2]]]);
//# sourceMappingURL=main.ca2a4927.chunk.js.map